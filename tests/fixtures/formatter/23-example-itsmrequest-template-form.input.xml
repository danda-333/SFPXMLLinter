<?xml version="1.0" encoding="utf-8"?>
<Form xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:dsp="http://www.gappex.com/sfp/DataSource/Parameters" xmlns:fcs="http://www.gappex.com/sfp/Form/Control/Settings" xmlns:dsf="http://www.gappex.com/sfp/DataSource/Froms" Ident="ITSMRequest" SegmentType="ITSMRequestSegment" PackageIdent="ITSMPackage" IsFolderTreePermission="true" IsDebug="true">
	<Usings>
		<Using Component="Common/FolderTreeSetting" />
		<Using Component="Common/PageSetting" FormIdent="ITSMRequest" />
		<Using Component="Common/SLACriteriaControls" />

		<Using Component="Common/Shared/Approval" FormIdent="ITSMRequest" />
		<Using Component="Common/Shared/Assign" FormIdent="ITSMRequest" />
		<Using Component="Common/Shared/FolderGroupSegment" FormIdent="ITSMRequest" />
		<Using Component="Common/Shared/ITSMKey" FormIdent="ITSMRequest" />
		<Using Component="Common/Shared/Resolve" FormIdent="ITSMRequest" />

		<Using Component="Common/Controls/ThisFormIdent" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/MainInfoHTMLContentView" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/AdditionalFields" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/ReporterControls" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/CommunicationControls" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/LinkControls" FormIdent="ITSMRequest" />
		<Using Component="Common/Controls/TimeLineControls" FormIdent="ITSMRequest" />

		<Using Component="Common/Buttons/SendToCategorizationButton" />
		<Using Component="Common/Buttons/SendToProcessButton" />
		<Using Component="Common/Buttons/ReturnToReporterButton" />
		<Using Component="Common/Buttons/ResendToProcessButton" />
		<Using Component="Common/Buttons/SupervisorApprovalButtons" />
		<Using Component="Common/Buttons/SuspendApprovalGroupButton" />
		<Using Component="Common/Buttons/AnswerApprovalButton" />
		<Using Component="Common/Buttons/AnswerSolutionButton" />
		<Using Component="Common/Buttons/SuspendSolutionGroupButton" />
		<Using Component="Common/Buttons/ResolveToReporterButton" />
		<Using Component="Common/Buttons/ClaimSolutionButton" />
		<Using Component="Common/Buttons/CloseButton" />
		<Using Component="Common/Buttons/CancelButton" />
		<Using Component="Common/Buttons/SaveGroupButton" />
		<Using Component="Common/Buttons/DeleteButton" />
		<Using Component="Common/Buttons/BackButton" />
	</Usings>
	<ExternalJavaScriptRelativePaths>
	</ExternalJavaScriptRelativePaths>
	<DataPermissions>
		<string>ITSMRequest</string>
		<string>ITSMRequestReporter</string>
		<string>ITSMRequestSharedReporter</string>

		<string>ITSMAuthor</string>
		<string>ITSMOperator</string>
		<string>ITSMSpecialist</string>
		<string>ITSMSupplier</string>

		<string>ITSMReporterBossApprover</string>
		<string>ITSMApproverGroupMember</string>
	</DataPermissions>
	<CreatePermissions>
		<string>ITSMAuthor</string>
		<string>ITSMOperator</string>
	</CreatePermissions>
	<DynamicPermission>
		<Columns>
			<Column Ident="PermissionIdent" DataBindType="Value"/>
		</Columns>
		<SQL><![CDATA[
			DECLARE @PermissionIDs dbo.ListNVarchar100Type;
			INSERT INTO @PermissionIDs VALUES ('ITSMAuthor');

      SELECT 'ITSMRequestSharedReporter' AS PermissionIdent
			FROM usr.ITSM_FolderTreeView as itsmFolTre
			WHERE
				itsmFolTre.FolderTreeIdent = @ITSMCompanyIdent
				AND itsmFolTre.IsShareAmongAuthors = @StateOne
				AND EXISTS(
					SELECT NULL
					FROM usr.ITSM_GetAllowedFolderTreeByAccountAndPermission(@UserID, @FolderGroupSegmentIdent, @PermissionIDs)
					WHERE
						FolderTreeIdent = itsmFolTre.FolderTreeIdent
				)
		]]></SQL>
		<Parameters>
			<dsp:Parameter xsi:type="dsp:ValueParameter" Ident="StateOne" DataType="Number" Value="1"/>
			<dsp:Parameter xsi:type="dsp:VariableParameter" Ident="UserID" DataType="Number" ConstantType="UserID" />
			<dsp:Parameter xsi:type="dsp:VariableParameter" Ident="ITSMCompanyIdent" DataType="VarChar" MaxLength="900"/>
			<dsp:Parameter xsi:type="dsp:ValueParameter" Ident="FolderGroupSegmentIdent" DataType="String" MaxLength="50" Value="ITSMCommonFolderGroup" />
		</Parameters>
	</DynamicPermission>
	<Settings>
	</Settings>
	<Buttons>
	</Buttons>

	<Controls>
		

		<Control xsi:type="TextBoxControl" Ident="Subject" DataType="String" TitleResourceKey="Subject_ITSM" IsFullText="true" IsReadOnly="true">
			<TimeLineDataBind TransformType="Copy" />
		</Control>

		<Control xsi:type="TextAreaControl" Ident="Description" DataType="String" Rows="5" TitleResourceKey="Description_ITSM" IsFullText="true" IsReadOnly="true">
			<TimeLineDataBind TransformType="Copy" />
		</Control>    

		<!-- ========== SKRYTÁ POLE PRO VÍCEKROKOVÉ SCHVALOVÁNÍ ========== -->
		<Control xsi:type="HiddenControl" Ident="ITSMApproveSettingID" DataType="Number" />
		<Control xsi:type="HiddenControl" Ident="CurrentApproveOrder" DataType="Number" />
		<Control xsi:type="HiddenControl" Ident="TotalApproveOrder" DataType="Number" />
		<Control xsi:type="HiddenControl" Ident="CurrentApproveGroupID" DataType="Number" />

	</Controls>
	<Components>
	</Components>
	<Sections>

		<Section xsi:type="ContentSection" Ident="BasicInformationSection" TitleResourceKey="BasicInformationSection_ITSM" IconCssClass="icon-bookmark">
			<HTMLTemplate><![CDATA[

				<div class="row">

					<div class="col-md-9"><!-- Levý sloupec -->

						<div class="row">
							<div class="col-md-12">
								<div class="card">
									<div class="card-header bg-white header-elements-inline">
										<h6 class="card-title">[#BasicInformation_ITSM#]</h6>
										<div class="header-elements">
											<div class="list-icons">
												<a class="list-icons-item" data-action="collapse"></a>
											</div>
										</div>
									</div>
									<div class="card-body">
										{{Component:Common/Shared/FolderGroupSegment,Section:Html}}

										<div class="row">
											<div class="col-md-12">
												<div class="form-group">
													<ControlLabel ControlID="Subject" />
													<Control ID="Subject" />
												</div>
											</div>
										</div>
										<div class="row">
											<div class="col-md-12">
												<div class="form-group">
													<ControlLabel ControlID="Description" />
													<Control ID="Description" />
												</div>
											</div>
										</div>
									</div>
									{{Component:Common/Controls/AdditionalFields,Section:Html}}
								</div>
							</div>
						</div>

						{{Component:Common/Controls/CommunicationControls,Section:Html}}

					</div><!-- //Levý sloupec -->

					<div class="col-md-3"><!-- Pravý sloupec -->

						{{Component:Common/Controls/ReporterControls,Section:Html}}
						{{Component:Common/Shared/Assign,Section:Html}}
						{{Component:Common/Shared/Approval,Section:Html}}
						{{Component:Common/Shared/Resolve,Section:Html}}

					</div><!-- //Pravý sloupec -->

				</div>
				
				{{Component:Common/Shared/ITSMKey,Section:Html}}
				{{Component:Common/Controls/ThisFormIdent,Section:Html}}
			]]></HTMLTemplate>
		</Section>

	</Sections>
</Form>
